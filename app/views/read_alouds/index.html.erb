<%= render 'home/header' %>

<div class="read-alouds container bg-white shadow p-2">
  <h6 class="font-weight-bold mb-4">Look at the text below. In 40 seconds, you must read this text aloud as naturally and clearly as possible. You have 40 seconds to read aloud.</h6>
  <div class="record-tool mb-4">
    <div class="status">
      <h5 class="text-info" id="time-prepaire">Begining in <span id="timePrepaire"> 00:00</span> seconds</h5>
      <h5 class="text-danger d-none" id="time-progess">Stop in <span id="timeProgess"> 00:00</span> seconds</h5>
      <h5 class="text-danger d-none" id="time-out">Time out</h5>
    </div>
  </div>
  <div style="width: 80%; margin: auto">
    <div class="data-source">
      <p class="text-justify m-4">
        5G networks that transform entertainment, communication and transportation may still be years away. But in manufacturing, the technology is already making a difference.
      </p>
    </div>
    <div class="result-read shadow rounded">
      <p class="text-justify p-4">
      </p>
    </div>
  </div>
  
</div>
<div class="action-bottom">
  <div class="float-right">
    <button class="edit btn bg-blue-en4all text-light mr-2" id="btnStart" onclick="start_Record()">START</button>
    <button class="edit btn bg-blue-en4all text-light mr-2 d-none" id="btnStop" onclick="stop_Record()">STOP</button>
    <button class="edit btn bg-blue-en4all text-light mr-2 d-none" id="btnAgain" onclick="reload_Record()">AGAIN</button>
    <button class="edit btn bg-blue-en4all text-light d-none" id="btnNext" onclick="next_Record()">NEXT</button>
  </div>
</div>

<script>

var timePre;
var timePost;
var pre;
var post;

function startTimerPre() {
  var timer = timePre, minutes, seconds;
  pre = setInterval(function () {
      minutes = parseInt(timer / 60, 10)
      seconds = parseInt(timer % 60, 10);

      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;

      document.querySelector('#timePrepaire').textContent = minutes + ":" + seconds;

      if (--timer < 0) {
        $("#time-prepaire").addClass("d-none");
        $("#time-progess").removeClass("d-none");
        

        $('#btnStart').addClass("d-none");
        $('#btnStop').removeClass("d-none");
        clearInterval(pre);

        startTimerPost();
      }
  }, 1000);
}

function startTimerPost() {
  var timer = timePost, minutes, seconds;
  post = setInterval(function () {
      minutes = parseInt(timer / 60, 10)
      seconds = parseInt(timer % 60, 10);

      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;

      document.querySelector('#timeProgess').textContent = minutes + ":" + seconds;

      if (--timer < 0) {
        $("#time-prepaire").addClass("d-none");
        $("#time-progess").addClass("d-none");
        $('#time-out').removeClass("d-none");

        $('#btnStop').addClass("d-none");
        $('#btnAgain').removeClass("d-none");
        $('#btnNext').removeClass("d-none");

        clearInterval(post);
      }
      else {}
  }, 1000);
}

function start_Record(){
  document.querySelector('#timePrepaire').textContent = "00:" + timePre;
  document.querySelector('#timeProgess').textContent = "00:" + timePost;

  $('#btnStart').addClass("d-none");
  $('#btnStop').removeClass("d-none");

  $('#time-prepaire').addClass("d-none");
  $('#time-progess').removeClass("d-none");
  $('#time-out').addClass("d-none");

  clearInterval(pre);
  clearInterval(post);
  startTimerPost();
}

function stop_Record(){
  document.querySelector('#timePrepaire').textContent = "00:" + timePre;
  document.querySelector('#timeProgess').textContent = "00:" + timePost;

  $('#btnStop').addClass("d-none");

  $('#btnAgain').removeClass("d-none");
  $('#btnNext').removeClass("d-none");

  $('#time-prepaire').addClass("d-none");
  $('#time-progess').addClass("d-none");
  $('#time-out').removeClass("d-none");

  clearInterval(pre);
  clearInterval(post);
}

function reload_Record() {
  document.querySelector('#timePrepaire').textContent = "00:" + timePre;
  document.querySelector('#timeProgess').textContent = "00:" + timePost;

  $('#btnAgain').addClass("d-none");
  $('#btnNext').addClass("d-none");
  $('#btnStart').removeClass("d-none");
  
  $('#time-prepaire').removeClass("d-none");
  $('#time-progess').addClass("d-none");
  $('#time-out').addClass("d-none");

  clearInterval(pre);
  clearInterval(post);
  startTimerPre();
}

function next_Record() {
  clearInterval(pre);
  clearInterval(post);
  
  timePre = 40;
  timePost = 40;

  document.querySelector('#timePrepaire').textContent = "00:" + timePre;
  document.querySelector('#timeProgess').textContent = "00:" + timePost;
  
  startTimerPre();
}

$(document).ready(function() {
  clearInterval(pre);
  clearInterval(post);
  
  timePre = 40;
  timePost = 40;

  var height = $(".data-source").height();
  $(".result-read").css("min-height", height);

  document.querySelector('#timePrepaire').textContent = "00:" + timePre;
  document.querySelector('#timeProgess').textContent = "00:" + timePost;
  
  startTimerPre();
});
</script>